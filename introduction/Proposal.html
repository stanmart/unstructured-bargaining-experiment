{{ block head }}
<link rel="stylesheet" href="{{ static 'live_bargaining.css' }}">
{{ endblock }}

{{ block title }}
Instructions 2/4
{{ endblock }}


{{ block content }}
<p>
    <h4><b> The bargaining interface:</b> </h4>
    This is a screenshot of the bargaining interface:
    <img src="{{ static 'bargaining_interface_2.png' }}" width="700"/>
    <p> The elements of the bargaining interface are as follows: </p>
    <ul>
        <li> 
            At the top, you will see the timer with the remaining time left for bargaining. 
            You will also see the values that each group generates in this round, as well as a brief recap of the instructions as a reminder.  
        </li>
        <li> 
            <b>"Chat"</b>: 
            <b>You will bargain over a text chat, you can do so in any way you like.</b>  
            There is only one group chat for all five players, private chats are not possible.  </li>
        <li> 
            <b>"Propose allocation"</b>: 
            During the bargaining, players can make proposals in the proposal interface to help coordination. 
            You can propose as many proposals as you like.
            For each proposal, select the players in the group, and then enter which amount they get below. 
            On the right you see at the top which value this group generates and below how much you have already allocated to its members.
            <ul> 
                <li> 
                    <p> <u> Example 1: </u>  </p>
                    <img src="{{ static 'proposal_only_subset_2.png' }}" width="600"/>
                    <p>
                        Player 4 proposes a group with Players 1-4, where Player 1 gets 30, Player 2 and 3 each get 10, and Player 4 gets 25. 
                        
                    </p>
                </li>
                <li> 
                    <p> <u> Example 2: </u>  </p>
                    <img src="{{ static 'proposal_leave_money_2.png' }}" width="600"/>
                    <p>
                        Player 1 proposes a group with Players 3-5, where Player 1 gets 40 and the other players each get 11. 
                        Note that not all of the value of a group has to be divided up. 
                    </p>
                    
                </li>
            </ul>

        </li>
        <li>
            <b> "Past proposals"</b>:
            All proposals will be logged here. 
            In the first two rows, you see the ID of the proposal (used for easier reference) and who made the proposal. 
            Players not included in the proposed group are marked with "-", for the players in the proposed group their proposed allocated amount is shown.
        </li>
        <li>
            <b> "Currently preferred proposal"</b>:
            In the bottom row you can indicate which proposal you currently prefer, using the proposal ID given in "Past proposals". 
            Note that this is just for coordination purposes: This just indicates which proposal a player currently prefers and can be changed at any time.
            (Just submit a new ID, or alternatively click "Clear preferred" if you want to leave this blank.)
            In the first two rows, you see the preferred proposals of each player and which payment this would result in, if everyone actually chose their preferred proposal.
            <p> <img src="{{ static 'choose_preferred.jpg' }}" width="560"/> </p>
        </li>
        <li> 
            <b> Note that communication between players is only possible during the five minutes of the bargaining phase. </b>
            Once the five minutes are up, you will not be able to communicate anymore.
            A new page will open and you will have to enter which proposal you are choosing as your final answer. 
        </li>
    </ul>
    
</p>

<div class="side-by-side" style="height: 400px;">

    <div class="section">
        <h3>Payoff function</h3>
        <table id="payoff-table" style="margin-bottom: 30px;">
            <colgroup>
                <col style="width: 50%;">
                <col style="width: 10%">
                <col style="width: 10%">
                <col style="width: 10%">
                <col style="width: 10%">
                <col style="width: 10%">
            </colgroup>
            <tr id="payoff-table-header">
                <th id="payoff-table-header-title">P1 + this many others</th>
            </tr>
            <tr id="payoff-table-values">
                <th>Group's value</th>
            </tr>
        </table>
        <div style="height: 230px; width: 350px">
            <canvas id="payoff-chart"></canvas>
        </div>
    </div>
    
    <div class="section vertical-fill">
        <h3>Past proposals</h4>
        <div class="vertical-fill" style="overflow-y: auto;">
            <table class="offer-table horizontal-rules shaded-rows">
                <thead>
                    <tr>
                        <th class="offer-id-col">ID</th>
                        <th class="offer-proposer-col">From</th>
                        <th class="offer-player-col player-1">P1</th>
                        <th class="offer-player-col player-2">P2</th>
                        <th class="offer-player-col player-3">P3</th>
                        <th class="offer-player-col player-4">P4</th>
                        <th class="offer-player-col player-5">P5</th>
                    </tr>
                </thead>
                <tbody id="past-offers-table"></tbody>
            </table>
        </div>
    </div>
        
</div>


<div class="section dim-section">
    <h3>Propose allocation</h2>    
    <table class="offer-table">
        <tbody>
            <tr>
                <th></th>
                <th class="offer-player-col player-1">Player 1</th>
                <th class="offer-player-col player-2">Player 2</th>
                <th class="offer-player-col player-3">Player 3</th>
                <th class="offer-player-col player-4">Player 4</th>
                <th class="offer-player-col player-5">Player 5</th>
                <th style="text-align: right;">Total</th>
            </tr>
            <tr style="height: 3em;">
                <th class="offer-left-col">In group</th>
                <td class="offer-player-col"><input type="checkbox" class="coalition-member" id="is-member-1"></td>
                <td class="offer-player-col"><input type="checkbox" class="coalition-member" id="is-member-2"></td>
                <td class="offer-player-col"><input type="checkbox" class="coalition-member" id="is-member-3"></td>
                <td class="offer-player-col"><input type="checkbox" class="coalition-member" id="is-member-4"></td>
                <td class="offer-player-col"><input type="checkbox" class="coalition-member" id="is-member-5"></td>
                <td class="offer-total-col"><div class="allocation-total" id="total-shareable">0</div></td>
            </tr>
            <tr style="height: 3em;">
                <th class="offer-left-col">Allocation</th>
                <td class="offer-player-col"><input type="number" disabled="true", value="0", class="allocation" id="allocation-1"></td>
                <td class="offer-player-col"><input type="number" disabled="true", value="0", class="allocation" id="allocation-2"></td>
                <td class="offer-player-col"><input type="number" disabled="true", value="0", class="allocation" id="allocation-3"></td>
                <td class="offer-player-col"><input type="number" disabled="true", value="0", class="allocation" id="allocation-4"></td>
                <td class="offer-player-col"><input type="number" disabled="true", value="0", class="allocation" id="allocation-5"></td>
                <td class="offer-total-col"><div class="allocation-total" id="total-shared">0</div></td>
            </tr>
        </tbody>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td style="text-align: right;"><button type="button" onclick="sendOffer()" id="btn-propose" style="width: 100%">Submit</button></td>
        </tr>
    </table>
</div>

<div>
    <p>Please try to make the following proposals before continuing:</p>
    <ul>
        <li id="proposal-grand-coalition">Every player is included</li>
        <li id="proposal-sub-coalition">Not every player is included</li>
        <li id="proposal-efficient">The whole value is divided</li>
        <li id="proposal-inefficient">Not the whole value is divided</li>
        <li id="proposal-invalid">You divide more than the maximum</li>
    </ul>
</div>


<div id="popup-full">
    <div id="popup" class="section">
        <h3 id="popup-title">Warning</h3>
        <p id="popup-content"></p>
        <button type="button" onclick="closePopup()" id="btn-close-popup">Close</button>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ static 'proposal_demo.js' }}"></script>


{{ next_button }}
{{ endblock }}